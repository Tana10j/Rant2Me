<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rant2Me - Chat</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Anonymous Chat</h1>
    <nav>
      <a href="index.html">Home</a>
      <a href="chat.html">Chat</a>
      <a href="help.html">Help Centre</a>
      <a href="faq.html">FAQ</a>
      <a href="token.html">Tokens</a>
      <a href="about.html">About Us</a>
      <a href="services.html">Services</a>
    </nav>
  </header>

  <section class="chat-box">
    <div class="bot-message" id="intro-message">ðŸ‘‹ Hello! Welcome to Rant2Me, your safe place to be heard. How can we support you today?</div>

    <div id="chat-output"></div>
    <textarea placeholder="Type your message here..."></textarea>
    <button id="sendBtn">Send</button>
    <p class="disclaimer">Your privacy is our priority. Nothing you say here will be saved.</p>
  </section>

  <section class="dropdown-services">
    <h2>Choose A Support Service</h2>
    <div class="service-list">
      <div class="service-card" onclick="location.href='chat-counselling.html'">
        <h3>Counselling</h3>
        <p>Talk to Tana â€“ Your friendly guide</p>
      </div>
      <div class="service-card" onclick="location.href='chat-nutrition.html'">
        <h3>Nutrition & Wellness</h3>
        <p>Talk to Dorcas â€“ Nutritionist & Wellness Coach</p>
      </div>
      <div class="service-card" onclick="location.href='chat-student.html'">
        <h3>Student Support</h3>
        <p>Talk to Chidera â€“ Student Guide & Buddy</p>
      </div>
      <div class="service-card" onclick="location.href='chat.html'">
        <h3>Anonymous Rant</h3>
        <p>No names. No records. Just honesty.</p>
      </div>
    </div>
  </section>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  let userRole = "user"; // default

  // Get the logged-in user's role
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      const token = await user.getIdTokenResult();
      userRole = token.claims.role || "user"; // 'counselling', 'nutrition', 'student' or default 'user'
      console.log("Logged in as role:", userRole);
    }
  });

  // Attach click handlers to each service card
  document.querySelectorAll(".service-card").forEach(card => {
    card.addEventListener("click", (e) => {
      const service = card.querySelector("h3").innerText.trim().toLowerCase();

      if (service.includes("counselling")) {
        if (userRole === "counselling") {
          location.href = "admin-counselling.html";
        } else {
          location.href = "chat-counselling.html";
        }
      }

      if (service.includes("nutrition")) {
        if (userRole === "nutrition") {
          location.href = "admin-nutrition.html";
        } else {
          location.href = "chat-nutrition.html";
        }
      }

      if (service.includes("student")) {
        if (userRole === "student") {
          location.href = "admin-student.html";
        } else {
          location.href = "chat-student.html";
        }
      }

      if (service.includes("anonymous")) {
        location.href = "chat.html"; // stays same for all
      }
    });
  });
</script>
  <script src="script.js"></script>
</body>
</html>
